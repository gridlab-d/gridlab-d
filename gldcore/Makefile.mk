dist_pkgdata_DATA += gldcore/tzinfo.txt
dist_pkgdata_DATA += gldcore/unitfile.txt

GLD_SOURCES_PLACE_HOLDER = 
GLD_SOURCES_PLACE_HOLDER += gldcore/aggregate.c
GLD_SOURCES_PLACE_HOLDER += gldcore/aggregate.h
GLD_SOURCES_PLACE_HOLDER += gldcore/build.h
GLD_SOURCES_PLACE_HOLDER += gldcore/class.c
GLD_SOURCES_PLACE_HOLDER += gldcore/class.h
GLD_SOURCES_PLACE_HOLDER += gldcore/cmdarg.c
GLD_SOURCES_PLACE_HOLDER += gldcore/cmdarg.h
GLD_SOURCES_PLACE_HOLDER += gldcore/compare.c
GLD_SOURCES_PLACE_HOLDER += gldcore/compare.h
GLD_SOURCES_PLACE_HOLDER += gldcore/complex.h
GLD_SOURCES_PLACE_HOLDER += gldcore/console.h
GLD_SOURCES_PLACE_HOLDER += gldcore/convert.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/convert.h
GLD_SOURCES_PLACE_HOLDER += gldcore/daemon.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/daemon.h
GLD_SOURCES_PLACE_HOLDER += gldcore/debug.c
GLD_SOURCES_PLACE_HOLDER += gldcore/debug.h
GLD_SOURCES_PLACE_HOLDER += gldcore/deltamode.c
GLD_SOURCES_PLACE_HOLDER += gldcore/deltamode.h
GLD_SOURCES_PLACE_HOLDER += gldcore/enduse.c
GLD_SOURCES_PLACE_HOLDER += gldcore/enduse.h
GLD_SOURCES_PLACE_HOLDER += gldcore/environment.c
GLD_SOURCES_PLACE_HOLDER += gldcore/environment.h
GLD_SOURCES_PLACE_HOLDER += gldcore/exception.c
GLD_SOURCES_PLACE_HOLDER += gldcore/exception.h
GLD_SOURCES_PLACE_HOLDER += gldcore/exec.c
GLD_SOURCES_PLACE_HOLDER += gldcore/exec.h
GLD_SOURCES_PLACE_HOLDER += gldcore/find.c
GLD_SOURCES_PLACE_HOLDER += gldcore/find.h
GLD_SOURCES_PLACE_HOLDER += gldcore/gld_sock.h
GLD_SOURCES_PLACE_HOLDER += gldcore/globals.c
GLD_SOURCES_PLACE_HOLDER += gldcore/globals.h
GLD_SOURCES_PLACE_HOLDER += gldcore/gridlabd.h
GLD_SOURCES_PLACE_HOLDER += gldcore/gui.c
GLD_SOURCES_PLACE_HOLDER += gldcore/gui.h
GLD_SOURCES_PLACE_HOLDER += gldcore/http_client.c
GLD_SOURCES_PLACE_HOLDER += gldcore/http_client.h
GLD_SOURCES_PLACE_HOLDER += gldcore/index.c
GLD_SOURCES_PLACE_HOLDER += gldcore/index.h
GLD_SOURCES_PLACE_HOLDER += gldcore/instance.c
GLD_SOURCES_PLACE_HOLDER += gldcore/instance_cnx.c
GLD_SOURCES_PLACE_HOLDER += gldcore/instance_cnx.h
GLD_SOURCES_PLACE_HOLDER += gldcore/instance.h
GLD_SOURCES_PLACE_HOLDER += gldcore/instance_slave.c
GLD_SOURCES_PLACE_HOLDER += gldcore/instance_slave.h
GLD_SOURCES_PLACE_HOLDER += gldcore/interpolate.c
GLD_SOURCES_PLACE_HOLDER += gldcore/interpolate.h
GLD_SOURCES_PLACE_HOLDER += gldcore/job.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/job.h
GLD_SOURCES_PLACE_HOLDER += gldcore/json.c
GLD_SOURCES_PLACE_HOLDER += gldcore/json.h
GLD_SOURCES_PLACE_HOLDER += gldcore/kill.c
GLD_SOURCES_PLACE_HOLDER += gldcore/kill.h
GLD_SOURCES_PLACE_HOLDER += gldcore/kml.c
GLD_SOURCES_PLACE_HOLDER += gldcore/kml.h
GLD_SOURCES_PLACE_HOLDER += gldcore/legal.c
GLD_SOURCES_PLACE_HOLDER += gldcore/legal.h
GLD_SOURCES_PLACE_HOLDER += gldcore/linkage.c
GLD_SOURCES_PLACE_HOLDER += gldcore/linkage.h
GLD_SOURCES_PLACE_HOLDER += gldcore/link.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/link.h
GLD_SOURCES_PLACE_HOLDER += gldcore/list.c
GLD_SOURCES_PLACE_HOLDER += gldcore/list.h
GLD_SOURCES_PLACE_HOLDER += gldcore/load.c
GLD_SOURCES_PLACE_HOLDER += gldcore/load.h
GLD_SOURCES_PLACE_HOLDER += gldcore/loadshape.c
GLD_SOURCES_PLACE_HOLDER += gldcore/loadshape.h
GLD_SOURCES_PLACE_HOLDER += gldcore/load_xml.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/load_xml.h
GLD_SOURCES_PLACE_HOLDER += gldcore/load_xml_handle.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/load_xml_handle.h
GLD_SOURCES_PLACE_HOLDER += gldcore/local.c
GLD_SOURCES_PLACE_HOLDER += gldcore/local.h
GLD_SOURCES_PLACE_HOLDER += gldcore/lock.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/lock.h
GLD_SOURCES_PLACE_HOLDER += gldcore/main.c
GLD_SOURCES_PLACE_HOLDER += gldcore/match.c
GLD_SOURCES_PLACE_HOLDER += gldcore/match.h
GLD_SOURCES_PLACE_HOLDER += gldcore/matlab.c
GLD_SOURCES_PLACE_HOLDER += gldcore/matlab.h
GLD_SOURCES_PLACE_HOLDER += gldcore/module.c
GLD_SOURCES_PLACE_HOLDER += gldcore/module.h
GLD_SOURCES_PLACE_HOLDER += gldcore/object.c
GLD_SOURCES_PLACE_HOLDER += gldcore/object.h
GLD_SOURCES_PLACE_HOLDER += gldcore/output.c
GLD_SOURCES_PLACE_HOLDER += gldcore/output.h
GLD_SOURCES_PLACE_HOLDER += gldcore/platform.h
GLD_SOURCES_PLACE_HOLDER += gldcore/property.c
GLD_SOURCES_PLACE_HOLDER += gldcore/property.h
GLD_SOURCES_PLACE_HOLDER += gldcore/random.c
GLD_SOURCES_PLACE_HOLDER += gldcore/random.h
GLD_SOURCES_PLACE_HOLDER += gldcore/realtime.c
GLD_SOURCES_PLACE_HOLDER += gldcore/realtime.h
GLD_SOURCES_PLACE_HOLDER += gldcore/sanitize.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/sanitize.h
GLD_SOURCES_PLACE_HOLDER += gldcore/save.c
GLD_SOURCES_PLACE_HOLDER += gldcore/save.h
GLD_SOURCES_PLACE_HOLDER += gldcore/schedule.c
GLD_SOURCES_PLACE_HOLDER += gldcore/schedule.h
GLD_SOURCES_PLACE_HOLDER += gldcore/server.c
GLD_SOURCES_PLACE_HOLDER += gldcore/server.h
GLD_SOURCES_PLACE_HOLDER += gldcore/setup.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/setup.h
GLD_SOURCES_PLACE_HOLDER += gldcore/stream.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/stream.h
GLD_SOURCES_PLACE_HOLDER += gldcore/stream_type.h
GLD_SOURCES_PLACE_HOLDER += gldcore/test.c
GLD_SOURCES_PLACE_HOLDER += gldcore/test_callbacks.h
GLD_SOURCES_PLACE_HOLDER += gldcore/test_framework.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/test_framework.h
GLD_SOURCES_PLACE_HOLDER += gldcore/test.h
GLD_SOURCES_PLACE_HOLDER += gldcore/threadpool.c
GLD_SOURCES_PLACE_HOLDER += gldcore/threadpool.h
GLD_SOURCES_PLACE_HOLDER += gldcore/timestamp.c
GLD_SOURCES_PLACE_HOLDER += gldcore/timestamp.h
GLD_SOURCES_PLACE_HOLDER += gldcore/transform.c
GLD_SOURCES_PLACE_HOLDER += gldcore/transform.h
GLD_SOURCES_PLACE_HOLDER += gldcore/unit.c
GLD_SOURCES_PLACE_HOLDER += gldcore/unit.h
GLD_SOURCES_PLACE_HOLDER += gldcore/validate.cpp
GLD_SOURCES_PLACE_HOLDER += gldcore/validate.h
GLD_SOURCES_PLACE_HOLDER += gldcore/version.c
GLD_SOURCES_PLACE_HOLDER += gldcore/version.h

GLD_SOURCES_EXTRA_PLACE_HOLDER =
GLD_SOURCES_EXTRA_PLACE_HOLDER += gldcore/cmex.c
GLD_SOURCES_EXTRA_PLACE_HOLDER += gldcore/cmex.h
GLD_SOURCES_EXTRA_PLACE_HOLDER += gldcore/xcore.cpp
GLD_SOURCES_EXTRA_PLACE_HOLDER += gldcore/xcore.h


if HAVE_MINGW

bin_SCRIPTS += gldcore/gridlabd

bin_PROGRAMS += gridlabd

gridlabd_CPPFLAGS =
gridlabd_CPPFLAGS += $(XERCES_CPPFLAGS)
gridlabd_CPPFLAGS += $(AM_CPPFLAGS)

gridlabd_LDFLAGS =
gridlabd_LDFLAGS += $(XERCES_LDFLAGS)
gridlabd_LDFLAGS += $(AM_LDFLAGS)

gridlabd_LDADD =
gridlabd_LDADD += $(XERCES_LIB)
gridlabd_LDADD += $(CURSES_LIB)
gridlabd_LDADD += -ldl

gridlabd_SOURCES =
gridlabd_SOURCES += $(GLD_SOURCES_PLACE_HOLDER)

EXTRA_gridlabd_SOURCES =
EXTRA_gridlabd_SOURCES += $(GLD_SOURCES_EXTRA_PLACE_HOLDER)

else

bin_SCRIPTS += gldcore/gridlabd

bin_PROGRAMS += gridlabd.bin

gridlabd_bin_CPPFLAGS =
gridlabd_bin_CPPFLAGS += $(XERCES_CPPFLAGS)
gridlabd_bin_CPPFLAGS += $(AM_CPPFLAGS)

gridlabd_bin_LDFLAGS =
gridlabd_bin_LDFLAGS += $(XERCES_LDFLAGS)
gridlabd_bin_LDFLAGS += $(AM_LDFLAGS)

gridlabd_bin_LDADD =
gridlabd_bin_LDADD += $(XERCES_LIB)
gridlabd_bin_LDADD += $(CURSES_LIB)
gridlabd_bin_LDADD += -ldl

gridlabd_bin_SOURCES =
gridlabd_bin_SOURCES += $(GLD_SOURCES_PLACE_HOLDER)

EXTRA_gridlabd_bin_SOURCES =
EXTRA_gridlabd_bin_SOURCES += $(GLD_SOURCES_EXTRA_PLACE_HOLDER)
endif

BUILT_SOURCES += gldcore/build.h

CLEANFILES += gldcore/build.h origin.txt

pkginclude_HEADERS =
pkginclude_HEADERS += gldcore/build.h
pkginclude_HEADERS += gldcore/class.h
pkginclude_HEADERS += gldcore/complex.h
pkginclude_HEADERS += gldcore/debug.h
pkginclude_HEADERS += gldcore/enduse.h
pkginclude_HEADERS += gldcore/exception.h
pkginclude_HEADERS += gldcore/loadshape.h
pkginclude_HEADERS += gldcore/lock.h
pkginclude_HEADERS += gldcore/module.h
pkginclude_HEADERS += gldcore/object.h
pkginclude_HEADERS += gldcore/property.h
pkginclude_HEADERS += gldcore/schedule.h
pkginclude_HEADERS += gldcore/test.h
pkginclude_HEADERS += gldcore/version.h

gridlabddir = $(prefix)/share/gridlabd
gridlabd_DATA = origin.txt

gldcore/gridlabd.in: gldcore/gridlabd.m4sh
	autoreconf -isf
	autom4te -l m4sh $< > $@

gldcore/build.h: buildnum

buildnum: utilities/build_number
	/bin/bash -c "source $(top_build_prefix)utilities/build_number $(top_srcdir) $(top_build_prefix)gldcore/build.h"
	(git remote -v ; git log -n 1 ; git status -s ; git diff ) > origin.txt
